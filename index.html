
<!DOCTYPE html>
<!-- Based template here:
https://github.com/Team-Code/KA_Offline -->
<html> 
 <head>
  <title>Alan's Train Simulator</title> 
 </head>
 <body>
  <p align="center"> 
   <canvas id="mycanvas"></canvas> 
  </p>
 </body>
 
 <!-- Run all the JavaScript stuff -->
 <!-- Include the processing.js library -->
 <!-- See https://khanacademy.zendesk.com/hc/en-us/articles/202260404-What-parts-of-ProcessingJS-does-Khan-Academy-support- for differences -->
 <script src="https://cdn.jsdelivr.net/processing.js/1.4.8/processing.min.js"></script> 
 
 <script>
    var sketchProc = function(processingInstance) {
     with (processingInstance) {
        size(3800, 800); 
        frameRate(60);
        







/////////////////////ProgramCodeGoesHere/////////////////////////////////////


/*A visual of the ATS system*/
/*By Alan*/

/*
Interactive features so far: 
-click train to toggle ATPM
-click station for menu
-station holds*


Display features:
-somewhat realistic LMAs
-dwells
-run shadows
-variance-dependent run shadow and label colors
-signal aspects
-flank protection

*/



//Code notes: positions are upper left (train, station)


//variables

var eastY = 450;
var westY = 346;

var power = true;

var speed = 60;         //speed
var e = 21;             //eastDwell
var w = 21;             //westDwell

//stationMenus E,W 0=null 1,2=TUN 3,4=BAY 5,6=PIM 7,8=LYO 9,10=PAR 11,12=RID, 13,14=UOT 15,16=LEE 17,18=HUR 19,20=TRE 21,22=STL 23,24=CYR 25,26=BLA
var stationMenus = [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false];

var variance = [0, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined];

var lma = [0, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false,];

var flankUOTwest;
var flankUOTeast;


//constructors

//trainConstructor
var Trains = function(position, docked, run, dwell, number, doorOpen, atpm, variance, hold, eb) {
    this.position = position;
    this.docked = docked;
    this.run = run;
    this.dwell = dwell;
    this.number = number;
    this.doorOpen = doorOpen;
    this.atpm = atpm;
    this.variance = variance;
    this.hold = hold;
    this.eb = eb;
};

//stationConstructor
var Stations = function(name, position, centerPlatform, eastHold, westHold, eastClose, westClose) {
    this.name = name;
    this.position = position;
    this.centerPlatform = centerPlatform;
    this.eastHold = eastHold;
    this.westHold = westHold;
    this.eastClose = eastClose;
    this.westClose = westClose;
};

//PseudosConstructor
var Pseudos = function(name, position, both, hold, eastHold, westHold, eastClose, westClose) {
    this.name = name;
    this.position = position;
    this.both = both;
    this.eastHold = eastHold;
    this.westHold = westHold;
    this.eastClose = eastClose;
    this.westClose = westClose;
};

//EastShadowConstructor
var EastShadows = function(run, position, dwell) {
    this.run = run;
    this.position = position;
};
//WestShadowConstructor
var WestShadows = function(run, position, dwell) {
    this.run = run;
    this.position = position;
};

//signalConstructor
var Signals = function(x, y, aspect, direction, label) {
	this.x = x;
	this.y = y;
	this.aspect = aspect;
	this.direction = direction;
	this.label = label;
};

//MenusConstructor
var Menus = function(config) {
    this.x = config.x || 10;
    this.y = config.y || 10;
    this.w = config.w || 80;
    this.h = config.h || 80;
};

//ButtonConstructor
var Button = function(config) {
    this.x = config.x || 25;
    this.y = config.y || 0;
    this.width = config.width || 30;
    this.height = config.height || 14;
    this.label = config.label || "";
    this.onClick = config.onClick || function() {};
};



//ButtonMethods
Button.prototype.isMouseInside = function() {
    return mouseX > this.x &&
           mouseX < (this.x + this.width) &&
           mouseY > this.y &&
           mouseY < (this.y + this.height);
};

Button.prototype.handleMouseClick = function() {
    if (this.isMouseInside()) {
        this.onClick();
    }
};

Button.prototype.draw = function() {
    //fill(0, 234, 255);
    rect(this.x, this.y, this.width, this.height);
    fill(0, 0, 0);
    textSize(19);
    //textAlign(LEFT, TOP);
    //text(this.label, this.x+10, this.y+this.height/4);
    text("test", this.x, this.y);
};





//station instances

//stations(name, position, centerPlatform, eastHold, westHold, eastClose, westClose)

var tun = new Stations("TUN", 130, false, false, false, false, false);
var bay = new Stations("BAY", 420, false, false, false, false, false);
var pim = new Stations("PIM", 540, true, false, false, false, false);
var lyo = new Stations("LYO", 800, false, false, false, false, false);
var par = new Stations("PAR", 1170, false, false, false, false, false);
var rid = new Stations("RID", 1340, false, false, false, false, false);
var uot = new Stations("UOT", 1790, false, false, false, false, false);
var lee = new Stations("LEE", 1970, false, false, false, false, false);
var hur = new Stations("HUR", 2080, false, false, false, false, false);
var tre = new Stations("TRE", 2420, false, false, false, false, false);
var stl = new Stations("STL", 3090, false, false, false, false, false);
var cyr = new Stations("CYR", 3210, true, false, false, false, false);
var bla = new Stations("BLA", 3630, true, false, false, false, false);


//pseudos(name, position, both, eastHold, westHold, eastClose, westClose)
var puot = new Pseudos("PUOT", 1520, true, false, false, false, false);
var phur = new Pseudos("PHUR", 2210, false, false, false, false, false);
var ptre = new Pseudos("PTRE", 2280, false, false, false, false, false);




//methods

//eastTrainDrawMethod
Trains.prototype.drawTrainEast = function() {

    //locatorEast
    if(this.position >= rid.position + 2 || this.position <= rid.position - 10) {
        if (frameCount % speed === 0) {
            this.position += floor(random(3, 13));
        }
        this.dwell = 21;
    } else if(this.position < rid.position + 2 && this.position > rid.position - 10 && this.dwell > 0) {
        this.position = rid.position;
        this.docked = true;
        if (frameCount % speed === 0) {
            this.dwell -= 1;
        }
        
        //dwellShowEast
        if(this.dwell < 20) {
            fill(0, 0, 0);
            textSize(13);
            text(this.dwell, rid.position - 35, eastY + 38);
        }
    } else if(this.position === rid.position && rid.eastHold === true) {
            fill(230, 0, 0);
            textSize(13);
            text(this.dwell, rid.position - 35, eastY + 38);
            if (frameCount % speed === 0) {
                this.dwell -= 1;
            }
    } else {
        this.position = rid.position + 10;
        this.docked = false;
    }
    
    //drawShapeEast
    strokeWeight(0.5);
    stroke(0, 0, 0);
    fill(0, 250, 250, 150);
    beginShape(); vertex(this.position, eastY); vertex(this.position + 22, eastY); vertex(this.position + 30, eastY + 8); vertex(this.position + 22, eastY + 15); vertex(this.position, eastY + 15); vertex(this.position, eastY); endShape(); 
    
    //doorSetEast
    if((this.dwell > 4 && this.dwell < 19) || this.hold === true) {
        this.doorOpen = true;
    } else {
        this.doorOpen = false;
    }
    
    //doorShowEast
    if(this.doorOpen === true) {
        noStroke();
        fill(90, 90, 90, 180);
        rect(this.position + 7, eastY + 2, 8, 8);
    }
    
    //atpmShowEast
    if((this.atpm === true)&&this.doorOpen === false) {
        fill(80, 80, 80);
        textSize(10);
        text("P", this.position + 6, eastY + 10);
    }
    
    //trainResetEast
        if(this.position > 2440) {
        this.position = -50;
    }
    
    //labelEast
    if(variance[1] > 100) {
        stroke(0, 0, 0);
        fill(255, 255, 0);
    } else if(variance[1] <= 100 && variance[1] > -11) {
        stroke(255, 255, 255);
        fill(0, 0, 0);
    } else {
        stroke(0, 0, 0);
        fill(0, 255, 0);
    }
    textSize(11);
    text(this.run + "BLW" + this.number, this.position - 18, eastY - 6);
    
    //LMAbooleansEast
    if(this.position < 100) {
        lma[9] = true;
    } else {
        lma[9] = false;
    }
    if(this.position < 100 || (this.position === 100 && this.dwell < 11)) {
        lma[10] = true;
    } else {
        lma[10] = false;
    }
    if(this.position < 100 || (this.position === 100 && this.dwell < 11)) {
        lma[11] = true;
    } else {
        lma[11] = false;
    }
    if((this.position > 100 && this.position < 258) || (this.position === 100 && this.dwell < 11)) {
        lma[12] = true;
    } else {
        lma[12] = false;
    }
    if(this.position > 100 && this.position < 262) {
        lma[13] = true;
    } else {
        lma[13] = false;
    }
    if(this.position > 100 && this.position < 285) {
        lma[14] = true;
    } else {
        lma[14] = false;
    }
    if(this.position > 100 && this.position < 385) {
        lma[15] = true;
    } else {
        lma[15] = false;
    }
    if(this.position > 100 && this.position < 410) {
        lma[16] = true;
    } else {
        lma[16] = false;
    }
    
    //flankEast
    if(this.position > 100 && this.position < 392) {
        flankUOTeast = true;
    } else {
        flankUOTeast = false;
    }
};




//westTrainDrawMethod
Trains.prototype.drawTrainWest = function() {
    
    //locatorWest
    if(this.position >= rid.position + 10 || this.position <= rid.position - 2) {
        if (frameCount % speed === 0) {
            this.position -= floor(random(3, 13));
        }
        this.dwell = 21;
    } else if(this.position < rid.position + 10 && this.position > rid.position - 2 && this.dwell > 0) {
        this.position = rid.position;
        this.docked = true;
        if (frameCount % speed === 0) {
            this.dwell -= 1;
        }
        
        //dwellShowWest
        if(this.dwell < 20) {
            fill(0, 0, 0);
            textSize(13);
            text(this.dwell, rid.position - 35, westY - 17);
        }
    } else if(this.position === rid.position && rid.westHold === true) {
            fill(230, 0, 0);
            textSize(13);
            text(this.dwell, rid.position - 35, westY - 17);
            if (frameCount % speed === 0) {
                this.dwell -= 1;
            }
    } else {
    this.position = rid.position - 10;
    this.docked = false;
    }
    
    //drawShapeWest
    strokeWeight(0.5);
    stroke(0, 0, 0);
    fill(0, 250, 250, 150);
    beginShape(); vertex(this.position, westY); vertex(this.position + 22, westY); vertex(this.position + 22, westY + 15); vertex(this.position, westY + 15); vertex(this.position - 8, westY + 8); vertex(this.position, westY); endShape();
    
        //doorSetWest
    if(this.dwell > 3 && this.dwell < 19) {
        this.doorOpen = true;
    } else {
            this.doorOpen = false;
    }
    
    //doorShowWest
    if(this.doorOpen === true) {
        noStroke();
        fill(90, 90, 90, 180);
        rect(this.position + 5, westY + 2, 8, 8);       /*fix size later? +tracks, flank, run shadows*/
    }
    
    //atpmShowWest
    if((this.atpm === true)&&this.doorOpen === false) {
        fill(80, 80, 80);
        textSize(10);
        text("P", this.position + 5, westY + 10);
    }
    
    //trainResetWest
    if(this.position <- 50) {
        this.position = 2430;
    }

    //labelWest
    if(variance[7] > 100) {
        stroke(0, 0, 0);
        fill(255, 255, 0);
    } else if(variance[7] <= 100 && variance[7] >- 11) {
        stroke(255, 255, 255);
        fill(0, 0, 0);
    } else {
        stroke(0, 0, 0);
        fill(0, 255, 0);
    }
    textSize(11);
    text("0113" + "TUW" + "26", this.position - 20, westY - 7);
    
    //LMAbooleansWest
    if(this.position < 100 || this.dwell < 10) {
        lma[1] = true;
    } else {
        lma[1] = false;
    }
    if((this.position > 100 && this.position < 350) || this.dwell < 10) {
        lma[2] = true;
    } else {
        lma[2] = false;
    }
    if((this.position > 100 && this.position < 350) || this.dwell < 10) {
        lma[3] = true;
    } else {
        lma[3] = false;
    }
    if(this.position > 110 && this.position < 380) {
        lma[4] = true;
    } else {
        lma[4] = false;
    }
    if(this.position > 225) {
        lma[5] = true;
    } else {
        lma[5] = false;
    }
    if(this.position > 240) {
        lma[6] = true;
    } else {
        lma[6] = false;
    }
    if(this.position > 280) {
        lma[7] = true;
    } else {
        lma[7] = false;
    }
    if(this.position > 360) {
        lma[8] = true;
    } else {
        lma[8] = false;
    }
    
    //flankWest 
    if(this.position > 250) {
        flankUOTwest = true;
    } else {
        flankUOTwest = false;
    }
};





//eastShadowDrawMethod
EastShadows.prototype.drawShadowEast = function() {
    //location/movement
    if(this.position >= rid.position + 12 || this.position <= rid.position) {
        if (frameCount % speed === 0) {
            this.position += floor(random(3, 13));
        }
        this.dwell = 15;
    } else if(this.position < rid.position + 12 && this.position > rid.position && this.dwell > 0) {
        this.position = rid.position + 10;
        if (frameCount % speed === 0) {
            this.dwell -= 1;
        }
    } else {
        this.position = rid.position + 20;
    }
    
    //runResetEast
    if(this.position > 2410) {
        this.position = -20;
    }
    
    //shadowColorEast
    strokeWeight(0.4);
    if(variance[1] > 100) {
        stroke(0, 0, 0);
        fill(255, 255, 0);
    } else if(variance[1] <= 100 && variance[1] >- 11) {
        stroke(255, 255, 255);
        fill(0, 0, 0);
    } else {
        stroke(0, 0, 0);
        fill(0, 255, 0);
    }
    ellipse(this.position, eastY + 8, 14, 14);
};



//westShadowDrawMethod
WestShadows.prototype.drawShadowWest = function() {
    //location/movement
    if(this.position >= rid.position + 20 || this.position <= rid.position + 8) {
        if (frameCount % speed === 0) {
            this.position -= floor(random(3, 13));
        }
        this.dwell = 15;
    } else if(this.position < rid.position + 20 && this.position > rid.position + 8 && this.dwell > 0) { 
        this.position = rid.position + 10;
        if (frameCount % speed === 0) {
            this.dwell -= 1;
        }
    } else {
        this.position = rid.position;
    }
    
    //runResetWest
    if(this.position <- 20) {
        this.position = 2420;
    }
    
    //shadowColorWest
    strokeWeight(0.4);
    if(variance[7] > 100) {
        stroke(0, 0, 0);
        fill(255, 255, 0);
    } else if(variance[7] <= 100 && variance[7] >- 11) {
        stroke(255, 255, 255);
        fill(0, 0, 0);
    } else {
        stroke(0, 0, 0);
        fill(0, 255, 0);
    }
    ellipse(this.position, westY + 8, 14, 14);
};



//signalDrawMethod
Signals.prototype.drawSignal = function() {
	strokeWeight(3);
	stroke(0, 0, 0);
	if(this.direction === 0) {
		line(this.x - 6, this.y - 4, this.x - 6, this.y + 4);
	} else {
		line(this.x + 5, this.y - 4, this.x + 5, this.y + 4);
	}
	strokeWeight(1);
	stroke(0, 0, 0);
	if(this.aspect === 1) {
		fill(0, 255, 0);
	} else if(this.aspect === 2) {
		fill(255, 255, 255);
	} else {
		fill(255, 0, 0);
	}
	ellipse(this.x, this.y, 7, 7);
};





var drawEastPortal = function(x) {
        strokeWeight(4);     //eastPortal
        noFill();
        stroke(0, 0, 0);
        beginShape(); vertex(x + 10, westY - 16); vertex(x, westY - 6); vertex(x, eastY + 20); vertex(x + 10, eastY + 30); endShape();
};

var drawWestPortal = function(x) {
        strokeWeight(4);
        noFill();
        stroke(0, 0, 0);
        beginShape(); vertex(x - 10, westY - 16); vertex(x, westY - 6); vertex(x, eastY + 20); vertex(x - 10, eastY + 30); endShape();
};

var markerDraw = function(x, y) {
    noFill();
    stroke(0, 0, 0);
    strokeWeight(0.4);
    triangle(x - 2.5, y - 4, x + 2.5, y - 4, x, y);    
};

var zoneBorderDraw = function(x) {
	for(i = 0; i < 18; i++) {
		fill(0, 0, 0);
		noStroke();
		rect(x, (westY - 48) + i*12, 3, 10);
	}
};

var gidsDraw = function(x) {
    stroke(0, 0, 0);
    fill(128, 128, 128);
    strokeWeight(0.2);
    rect(x, westY - 44, 4, 208);
};

var drawUpCross = function(x, y) {
        quad(x + 5, y + 73, x + 14, y + 79, x + 61, y + 6, x + 53, y);    
};

var drawDownCross = function(x, y) {
        quad(x + 5, y + 6, x + 14, y, x + 61, y + 73, x + 53, y + 79); 
};




//StationDrawMethod
Stations.prototype.drawStation = function() {
    //GIDS
    gidsDraw(this.position - 4);
    gidsDraw(this.position + 28);
    
    //markers
    markerDraw(this.position + 5, westY - 2);
    markerDraw(this.position + 22, westY - 2);
    markerDraw(this.position + 5, eastY - 2);
    markerDraw(this.position + 22, eastY - 2);
    
    //platforms
    strokeWeight(0.5);
    if(this.centerPlatform === false) {
        if(this.eastClose === true) {
            fill(195, 0, 0);
        } else {
            fill(0, 0, 255);
        }
        stroke(0, 0, 0);
        rect(this.position, eastY + 36, 26, 12);
        if(this.eastHold === true) {
            fill(255, 255, 0);
            rect(this.position, eastY + 36, 26, 6);
        }
        
        if(this.westClose === true) {
            fill(195, 0, 0);
        } else {
            fill(0, 0, 230);
        }
        stroke(0, 0, 0);
        rect(this.position, westY - 36, 26, 12);
        if(this.westHold === true) {
            fill(255, 255, 0);
            rect(this.position, westY - 30, 26, 6);
        }
    } else {                                ///////////centerPlatform
        if(this.eastClose === true) {
            fill(195, 0, 0);
        } else {
            fill(0, 0, 255);
        }
        stroke(0, 0, 0);
        rect(this.position, eastY - 38, 26, 12);
        if(this.eastHold === true) {
            fill(255, 255, 0);
            rect(this.position, eastY - 32, 26, 6);
        }
        
        if(this.westClose === true) {
            fill(195, 0, 0);
        } else {
            fill(0, 0, 230);
        }
        stroke(0, 0, 0);
        rect(this.position, westY + 42, 26, 12);
        if(this.westHold === true) {
            fill(255, 255, 0);
            rect(this.position, westY + 42, 26, 6);
        }
    }
    
    //platformLabels
    fill(0, 255, 0);
    textSize(13);
    if(this.centerPlatform === false) {
        text(this.name + "-E", this.position - 6, eastY + 71);
        text(this.name + "-W", this.position - 6, westY - 51);
    } else {
        text(this.name + "-E", this.position + 38, eastY - 26);
        text(this.name + "-W", this.position + 38, westY + 53);
    }

};

//PseudoDrawMethod
Pseudos.prototype.drawPseudo = function() {
        noStroke();
    fill(88, 88, 88);
    rect(this.position, westY - 36, 26, 12);

    fill(0, 255, 0);
    textSize(13);
    text(this.name + "-W", this.position - 12, westY - 46);
    if(this.both === true) {
        fill(88, 88, 88);
	rect(this.position, eastY + 36, 26, 12);
	fill(0, 255, 0);
        text(this.name + "-E", this.position - 12, eastY + 70);
    }
	//markers
	markerDraw(this.position + 1, westY - 2);
	markerDraw(this.position + 19, westY - 2);
	if(this.both === true) {
		markerDraw(this.position + 1, eastY - 2);
		markerDraw(this.position + 19, eastY - 2);
	}
};




//StationMenuMethod
Menus.prototype.drawStationMenu = function() {
    fill(210, 210, 210);
    stroke(0,0,0);
    strokeWeight(1);
    rect(this.x + 20, this.y + 10, this.w, this.h);
    fill(0, 0, 0);
    textSize(12);
    text("Set/Clear Hold", this.x + 26, this.y + 26);
    text("Open/Close", this.x + 26, this.y + 42);
    text("Adjust Dwells", this.x + 26, this.y + 58);
};
    



//instances


//Trains(position, docked, run, dwell, number, doorOpen, atpm, variance, hold, eb)

var trainA = new Trains(-40, false, "0101", 20, "01", false, false, 0, false, false);
//var trainB = new Trains(undefined, false, "0102", true, "02", false, false, 0, false, false);
var trainG = new Trains(420, false, "0107", 20, "07", false, false, 0, false, false);

//??var trains = [trainA, trainG];

//runs (run, position)
var run0101 = new EastShadows("0101", 30);
var run0107 = new WestShadows("0107", 350);





var drawLMAeast = function(eastStart, eastEnd) {
    var eastMidline = eastY + 7;
    stroke(0, 255, 0);
    strokeWeight(4);
    line(eastStart, eastMidline, eastEnd, eastMidline);
    noStroke();
    fill(0, 255, 0);
    triangle(eastEnd, eastMidline - 4, eastEnd + 7, eastMidline, eastEnd, eastMidline + 4); 
};  //drawLMAeast


var drawLMAwest = function(westStart, westEnd) {
    var westMidline = westY + 7;
    stroke(0, 255, 0);
    strokeWeight(4);
    line(westStart, westMidline, westEnd, westMidline);
    noStroke();
    fill(0, 255, 0);
    triangle(westStart, westMidline - 4, westStart - 7, westMidline, westStart, westMidline + 4);//LMA
};  //drawLMAwest


var drawMRReast = function(eastStart, eastEnd) {
        
    var eastMidline = eastY + 7;
    stroke(255, 0, 0);
    strokeWeight(3);
    line(eastStart, eastMidline, eastEnd, eastMidline);
    noStroke();
    fill(255, 0, 0);
    triangle(eastEnd, eastMidline - 4, eastEnd + 7, eastMidline, eastEnd, eastMidline + 4);   
};  //drawMRReast


var drawMRRwest = function(westStart, westEnd) {
    var westMidline = westY + 7;
    stroke(255, 0, 0);
    strokeWeight(3);
    line(westStart, westMidline, westEnd, westMidline);
    noStroke();
    fill(255, 0, 0);
    triangle(westStart, westMidline - 4, westStart - 7, westMidline, westStart, westMidline + 4);//LMA
};  //drawMRRwest



//signalInstances(x, y, aspect, direction, label)
var sig11 = new Signals(tun.position + 47, westY + 31, 0, 0, "1-E-1");
var sig14 = new Signals(tun.position + 130, eastY - 14, 0, 1, "1-W-4");
















var stationMenu = new Menus({
    x: mouseX,
    y: mouseY,
    w: 100,
    h: 80,
});








///////////////////////////////////////////////////////////////////////////////////
//                                                              DRAW
///////////////////////////////////////////////////////////////////////////////////


draw = function() {
    
    background(112, 112, 112);    
    
    
    var btn1 = new Button({
        x: trainA.position - 5,
        y: eastY,
        onClick: function() {
            trainA.atpm = !trainA.atpm;
        },
    });
    
    var btn7 = new Button({
        x: trainG.position - 5,
        y: westY,
        onClick: function() {
            trainG.atpm = !trainG.atpm;
        },
    });

    var btnSH = new Button({
        x: stationMenu.x + 20,
        y: stationMenu.y + 10,
        width: stationMenu.w,
        height: 16,
        onClick: function() {
            if(stationMenus[11] === true) {
                stationMenus[11] = false;
                rid.eastHold = !rid.eastHold;
            }
            if(stationMenus[12] === true) {
                stationMenus[12] = false;
                rid.westHold = !rid.westHold;
            }
        }
    });
    
    var btnSC = new Button({
        x:stationMenu.x + 20,
        y: stationMenu.y + 26,
        width: stationMenu.w,
        height: 16,
        onClick: function() {
            if(stationMenus[11] === true) {
                stationMenus[11] = false;
                rid.eastClose = !rid.eastClose;
            }
            if(stationMenus[12] === true) {
                stationMenus[12] = false;
                rid.westClose = !rid.westClose;
            }
        }
    });
    
    


    var btnRidE = new Button({
        x: rid.position,
        y: eastY + 26,
        width: 20,
        onClick: function() {
            stationMenus[11] = true;
            stationMenu.x = mouseX;
            stationMenu.y = mouseY;
        }
    }); 
    
    var btnRidW = new Button({
        x: rid.position,
        y: westY - 26,
        width: 20,
        onClick: function() {
            stationMenus[12] = true;
            stationMenu.x = mouseX;
            stationMenu.y = mouseY;
        }
    });
    






    
    variance[1] = run0101.position - trainA.position;
    variance[7] = trainG.position - run0107.position;
    

    


    //position, docked, run, directionE, number, doorOpen, atpm, variance, hold, eb
    /*fill(0,0,0);
    textSize(10);
    text(trainA.position+"_"+trainA.docked+"_"+trainA.run+"_"+trainA.dwell+"_"+trainA.number+"_"+trainA.doorOpen+"_"+trainA.atmp+"_"+trainA.variance+"_"+trainA.hold+"_"+trainA.eb,20,20);
*/
    

	gidsDraw(puot.position + 35);		//portals
	drawEastPortal(puot.position - 2);
	
	gidsDraw(642);
	drawWestPortal(640);
	markerDraw(580, eastY - 2);
	markerDraw(580, westY - 2); //westDtPortal

	gidsDraw(3062);
	drawWestPortal(3060);
	markerDraw(3052, eastY - 2);
	markerDraw(3052, westY - 2); //westStlPortal

	gidsDraw(3144);
	drawEastPortal(3150);
	markerDraw(3158, eastY - 2);
	markerDraw(3158, westY - 2); //eastStlPortal


	zoneBorderDraw(600);			//zones
	zoneBorderDraw(2035);
	zoneBorderDraw(3175);

	markerDraw(600, westY - 2);		//zone markers
	markerDraw(600, eastY - 2);
	markerDraw(2035, westY - 2);
	markerDraw(2035, eastY - 2);
	markerDraw(3175, westY - 2);
	markerDraw(3175, eastY - 2);

	markerDraw(270, westY - 2);
	markerDraw(270, eastY - 2); //swt302marker
	markerDraw(1680, westY - 2);
	markerDraw(1680, eastY - 2); //swt310marker
	markerDraw(2630, eastY - 2);
	markerDraw(2610, westY - 2); //swt319markers
	markerDraw(2710, westY - 2);
	markerDraw(2845, eastY - 2);
	markerDraw(2880, westY - 2); //swt324markers
	markerDraw(2915, eastY - 2);
	markerDraw(3435, westY - 2); //swt327marker
	markerDraw(3455, eastY - 2);


    
	sig11.drawSignal();
	sig14.drawSignal();


    //signalAspects
    strokeWeight(0.8);
    stroke(0, 0, 0);

	fill(255, 0, 0);
	ellipse(tun.position + 130, eastY - 14, 7, 7); //302

	if(1 === 1) {
		fill(0, 255, 0);
	} else {
		fill(255, 0, 0);
	} 
	ellipse(tun.position + 41, eastY + 29, 7, 7); //303
    
	if(1 === 1) {
		fill(0, 255, 0);
	} else {
		fill(255, 0, 0);
	}
	ellipse(tun.position + 130, westY - 14, 7, 7); //304


	fill(255, 0, 0);
	ellipse(lyo.position + 157, westY + 31, 7, 7); //305

	fill(255, 0, 0);
	ellipse(lyo.position + 242, 436, 7, 7); //306

	if(1 === 1) {
		fill(0, 255, 0);
	} else {
		fill(255, 0, 0);
	} 
	ellipse(lyo.position + 166, eastY + 29, 7, 7); //307
    
	if(1 === 1) {
		fill(0, 255, 0);
	} else {
		fill(255, 0, 0);
	}
	ellipse(lyo.position + 235, westY - 14, 7, 7); //308



	fill(255, 0, 0);
	ellipse(puot.position + 47, westY + 31, 7, 7); //309

	fill(255, 0, 0);
	ellipse(puot.position + 130, 436, 7, 7); //310

	if(1 === 1) {
		fill(0, 255, 0);
	} else {
		fill(255, 0, 0);
	} 
	ellipse(puot.position + 24, eastY + 27, 7, 7); //311
    
	if(1 === 1) {
		fill(0, 255, 0);
	} else {
		fill(255, 0, 0);
	}
	ellipse(puot.position + 130, 332, 7, 7); //312




    
/*   
	strokeWeight(3);
	line(tun.position + 42, westY + 27, tun.position + 42, westY + 34);
	line(tun.position + 134, eastY - 18, tun.position + 134, eastY - 11); 
	line(tun.position + 36, eastY + 25, tun.position + 36, eastY + 32); 
	line(tun.position + 134, westY - 18, tun.position + 134, westY - 11);

	line(lyo.position + 152, westY + 27, lyo.position + 152, westY + 34);
	line(lyo.position + 246, eastY - 18, lyo.position + 246, eastY - 11);
	line(lyo.position + 161, eastY + 25, lyo.position + 161, eastY + 32);
	line(lyo.position + 239, westY - 18, lyo.position + 239, westY - 11); 

	line(puot.position + 42, westY + 27, puot.position + 42, westY + 34);
	line(puot.position + 134, eastY - 18, puot.position + 134, eastY - 10);
	line(puot.position + 19, eastY + 23, puot.position + 19, eastY + 30); 
	line(puot.position + 134, westY - 18, puot.position + 134, westY - 11); 
*/



    
    

    

	//methodCalls

	tun.drawStation();
	bay.drawStation();
	pim.drawStation();
	lyo.drawStation();
	par.drawStation();
	rid.drawStation();
	uot.drawStation();
	lee.drawStation();
	hur.drawStation();
	tre.drawStation();
	stl.drawStation();
	cyr.drawStation();
	bla.drawStation();

    
	puot.drawPseudo();
	phur.drawPseudo();
	ptre.drawPseudo();



	fill(255, 130, 0);
	textSize(12);
	
	text("SW_301", tun.position - 13, westY + 35);     //swtNumber
	text("SW_302", tun.position + 140, eastY - 17);
	text("SW_303", tun.position - 5, eastY - 17);
	text("SW_304", tun.position + 130, westY + 35);
	
	text("SW_305", lyo.position + 95, westY + 35);
	text("SW_306", lyo.position + 260, eastY - 17);    //+105 lyo
	text("SW_307", lyo.position + 110, eastY - 17);
	text("SW_308", lyo.position + 245, westY + 35);

	text("SW_309", puot.position - 10, westY + 35);
	text("SW_310", puot.position + 140, eastY - 17);
	text("SW_311", puot.position + 5, eastY - 17);
	text("SW_312", puot.position + 125, westY + 35); 

	text("SW_313", 2170, eastY - 17);
	text("SW_314", 2155, westY - 11);
	text("SW_315", 2330, westY - 11);
	text("SW_316", 2398, eastY - 14);

	text("SW_317", 2485, eastY - 11);
	text("SW_318", 2490, westY + 35);
	text("SW_319", 2660, westY + 35);
	text("SW_320", 2700, eastY - 11);

	text("SW_323", 2890, eastY - 11);
	text("SW_324", 2850, westY + 35);
	text("SW_325", 2990, westY + 31);
	text("SW_326", 2950, eastY - 11);

	text("SW_327", 3470, westY + 35);
	text("SW_328", 3420, eastY - 11);
	text("SW_329", 3508, eastY - 22);
	text("SW_330", 3528, westY + 35);






    
	fill(192, 192, 192);
	if(power === true) {
		noStroke();
	} else {
		stroke(0, 255, 0);
		strokeWeight(3);
	}
	rect(20, eastY + 2, 3760, 11);                      //track1
	rect(20, westY + 2, 3760, 11);                      //track2
    


	drawUpCross(tun.position + 50, westY + 19);	//switches
	drawDownCross(tun.position + 50, westY + 19);
	drawUpCross(lyo.position + 170, westY + 19);
	drawDownCross(lyo.position + 170, westY + 19);
	drawUpCross(puot.position + 50, westY + 19);
	drawDownCross(puot.position + 50, westY + 19);
	drawUpCross(2130, westY + 19); //hur
	drawDownCross(2320, westY + 19);
	drawUpCross(2530, westY + 19);
	drawDownCross(2630, westY + 19);
	drawUpCross(2860, westY + 19);
	drawDownCross(2960, westY + 19);
	drawDownCross(3440, westY + 19);
	drawUpCross(3540, westY + 19);
	
    
    
    if(lma[1]=== true) {
        drawLMAwest(0, 96);     //LMA1            //westLMAs
    }
    if(lma[2] === true) {
        drawLMAwest(105, 109);  //LMA2
    }
    if(lma[3] === true) {
        drawLMAwest(118, 126);  //LMA3
    }
    if(lma[4] === true) {
        drawLMAwest(135, 240);  //LMA4
    }
    if(lma[5] === true) {
        drawLMAwest(249, 258);  //LMA5
    }
    if(lma[6] === true){
        drawLMAwest(265, 280);  //LMA6
    }
    if(lma[7] === true) {
        drawLMAwest(310, 360);  //LMA7
    }
    if(lma[8] === true) {
        drawLMAwest(390, 410);  //LMA8
    }
    
    if(lma[9] === true) {
        drawLMAeast(0, 96);     //LMA9            //eastLMAs
    }
    if(lma[10] === true) {
        drawLMAeast(105, 109);  //LMA10
    }
    if(lma[11] === true) {
        drawLMAeast(117, 125);  //LMA11
    }
    if(lma[12] === true) {
        drawLMAeast(134, 240);  //LMA12
    }
    if(lma[13] === true) {
        drawLMAeast(249, 258);  //LMA13
    }
    if(lma[14] === true) {
        drawLMAeast(265, 280);  //LMA14
    }
    if(lma[15] === true) {
        drawLMAeast(310, 360);  //LMA15
    }
    if(lma[16] === true) {
        drawLMAeast(390, 410);  //LMA16
    }
    
    if(flankUOTeast === true || flankUOTeast === true) {         //switchReservationEast
        stroke(0, 0, 0);
        strokeWeight(0.4);
        fill(255, 0, 255);
        ellipse(puot.position + 52, eastY + 7, 13, 13);
        ellipse(puot.position + 116, westY + 7, 13, 13);
        ellipse(puot.position + 116, eastY + 7, 13, 13);
        ellipse(puot.position + 52, westY + 7, 13, 13);
    }   //flank
    







    //var trains = [trainA, trainG];
    //trains[0].drawEast();
    //for loop through train array (array east, array west? or alternate?)





    //moreMethodCalls    
    
    trainA.drawTrainEast();
    trainG.drawTrainWest();
    //trainB.drawEastTrain();
    
    run0101.drawShadowEast();
    run0107.drawShadowWest();
    
    //btn1.draw();
    //btn7.draw();

    mouseClicked = function() {
    btn1.handleMouseClick();
    btn7.handleMouseClick();
    btnRidE.handleMouseClick();
    btnRidW.handleMouseClick();
    btnSH.handleMouseClick();
    btnSC.handleMouseClick();
    };
    
    
    if(stationMenus[11] === true) {
        stationMenu.drawStationMenu();
    }
    
    if(stationMenus[12] === true) {
        stationMenu.drawStationMenu();
    }
    
    
};


//planned features to add
    //buttons-x,y,w,h - functions!
    //subdivide LMAs
    //stnHold
    //stnClose
    //sysHold
    //disturb switch
    //MRR
    //powerStatus
    //eb
    //alt TDT
    
    //dwell+/-
    
    //cross switches?



//if (frameCount % 60 === 0)      <--slow movement?
//if (random(1) < 0.5)          <--50/50 random?





//button constructor-> config construction
//config object into the constructor
//allows defaults for undefined properties

/*
if a drawn button is needed
Button.prototype.draw = function() {
    fill(0, 234, 255);
    rect(this.x, this.y, this.width, this.height);
    fill(0, 0, 0);
    textSize(19);
    textAlign(LEFT, TOP);
    text(this.label, this.x+10, this.y+this.height/4);
}; --> btn1.draw();



var btn1 = new Button({
    x: this.position,
    y: 100,
    onClick: function() {
        text/rect
    }
});




var btn2 = new Button({
    x: 100,
    y: 213,
    label: "No! Click ME!",
    onClick: function() {
        text("Yay, you picked me!", this.x, this.y+this.height);
    }
});
btn2.draw();



*/





    }};

    // Get the canvas that Processing-js will use
    var canvas = document.getElementById("mycanvas"); 
    // Pass the function sketchProc (defined in myCode.js) to Processing's constructor.
    var processingInstance = new Processing(canvas, sketchProc); 
 </script>

</html>